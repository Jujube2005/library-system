<div class="reservations-container">
  <header class="reservations-header">
    <span class="view-tag">Personal <!-- v2 --></span>
    <h1 class="page-title">My Book <br>Reservations</h1>
  </header>

  <!-- Loading Skeleton -->
  <div class="skeleton-list" *ngIf="loading">
    <div class="skeleton-card skeleton" *ngFor="let i of [1,2,3]"></div>
  </div>

  <p class="error-msg" *ngIf="!loading && error">{{ error }}</p>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!loading && !error && !reservations.length">
    <span class="material-icons empty-icon">turned_in_not</span>
    <p class="notify-meta">คุณยังไม่มีรายการจองหนังสือในขณะนี้</p>
  </div>

  <!-- Reservation List -->
  <div class="reservation-list loading-fade" *ngIf="!loading && !error && reservations.length">
    <div class="reservation-card" *ngFor="let r of reservations">
      <div class="book-info">
        <span class="res-category">{{ r.books?.category || 'Collection' }}</span>
        <h3 class="res-title">{{ r.books?.title || 'Unknown Title' }}</h3>
        <span class="res-author">By {{ r.books?.author || 'Unknown Author' }}</span>
      </div>

      <div class="status-section">
        <div class="meta-info">
          <span class="meta-label">Reserved On</span>
          <span class="meta-value">{{ r.reserved_at | date:'dd MMM yyyy' }}</span>
        </div>

        <div class="meta-info">
          <span class="meta-label">Status</span>
          <span class="status-badge" [ngClass]="'status-' + r.status">
            {{ r.status }}
          </span>
        </div>

        <button class="cancel-btn" *ngIf="r.status === 'pending'" (click)="cancel(r)">
          Cancel Request
        </button>
      </div>
    </div>
  </div>
</div>